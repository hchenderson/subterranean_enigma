
{
  "entities": {
    "AdminUser": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AdminUser",
      "type": "object",
      "description": "Represents an administrative user with login credentials.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the admin user."
        },
        "email": {
          "type": "string",
          "description": "Email address of the admin user.",
          "format": "email"
        },
        "googleId": {
          "type": "string",
          "description": "Google ID of the admin user if signed in with Google."
        }
      },
      "required": [
        "id",
        "email"
      ]
    },
    "ParticipantUser": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ParticipantUser",
      "type": "object",
      "description": "Represents a participant user identified by a unique code.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the participant user."
        },
        "participantCode": {
          "type": "string",
          "description": "Unique code assigned to the participant user for login."
        },
        "gameId": {
          "type": "string",
          "description": "The ID of the game this participant belongs to."
        },
        "displayName": {
          "type": "string",
          "description": "The participant's chosen display name."
        },
        "teamId": {
          "type": "string",
          "description": "The ID of the team this participant belongs to."
        }
      },
      "required": [
        "id",
        "participantCode",
        "gameId"
      ]
    },
    "GeneratedCode": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "GeneratedCode",
      "type": "object",
      "description": "Represents a generated, single-use code for a participant to join a game.",
      "properties": {
        "participantCode": {
          "type": "string",
          "description": "The unique, all-caps, hyphenated code."
        }
      },
      "required": [
        "participantCode"
      ]
    },
    "GameState": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "GameState",
      "type": "object",
      "description": "Represents the state of the game for a specific user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the game state entry."
        },
        "participantUserId": {
          "type": "string",
          "description": "Reference to ParticipantUser. (Relationship: ParticipantUser 1:N GameState)"
        },
        "completion": {
          "type": "object",
          "description": "Tracks completion status for each storyline.",
          "properties": {
            "archive": { "type": "boolean" },
            "well": { "type": "boolean" },
            "network": { "type": "boolean" }
          }
        },
        "keys": {
          "type": "object",
          "description": "Tracks collected key fragments.",
          "properties": {
            "archive": { "type": "boolean" },
            "well": { "type": "boolean" },
            "network": { "type": "boolean" }
          }
        }
      },
      "required": [
        "id",
        "participantUserId"
      ]
    },
    "Material": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Material",
      "type": "object",
      "description": "Represents a printable material for a game room.",
      "properties": {
        "title": {
          "type": "string",
          "description": "Title of the material."
        },
        "description": {
          "type": "string",
          "description": "Optional description of the material."
        },
        "storagePath": {
          "type": "string",
          "description": "Path to the file in Firebase Storage."
        },
        "phase": {
          "type": "string",
          "description": "Optional game phase this material is for."
        },
        "printed": {
          "type": "boolean",
          "description": "Whether the material has been printed."
        },
        "required": {
          "type": "boolean",
          "description": "Whether the material is required."
        }
      },
      "required": [
        "title",
        "storagePath"
      ]
    },
    "Hint": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Hint",
      "type": "object",
      "description": "Represents a single hint for a puzzle, intended for admin use.",
      "properties": {
        "puzzleKey": {
          "type": "string",
          "description": "Identifier for the puzzle this hint belongs to."
        },
        "team": {
          "type": "string",
          "description": "The team this hint is intended for ('global' for all teams)."
        },
        "order": {
          "type": "number",
          "description": "The progressive order of the hint (e.g., 1 for the first, gentle hint)."
        },
        "text": {
          "type": "string",
          "description": "The content of the hint."
        },
        "revealedFor": {
          "type": "array",
          "description": "An array of team IDs that have received this hint.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "puzzleKey",
        "team",
        "order",
        "text"
      ]
    },
    "TeamHint": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "TeamHint",
      "type": "object",
      "description": "A hint that has been explicitly revealed to a specific team by an admin.",
      "properties": {
        "teamId": {
          "type": "string",
          "description": "The ID of the team that should see this hint."
        },
        "puzzleKey": {
          "type": "string",
          "description": "Identifier for the puzzle this hint belongs to."
        },
        "text": {
          "type": "string",
          "description": "The content of the hint."
        }
      },
      "required": [
        "teamId",
        "puzzleKey",
        "text"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous",
      "google.com"
    ]
  },
  "firestore": {
    "/admins/{adminId}": {
      "schema": {
        "$ref": "#/backend/entities/AdminUser"
      },
      "description": "Stores admin user information. Only authenticated admins can read/write their own data."
    },
    "/participants/{participantId}": {
      "schema": {
        "$ref": "#/backend/entities/ParticipantUser"
      },
      "description": "Stores participant user information. Can only be created by the user, and only the user can read/write their own data."
    },
    "/games/{gameId}/generatedCodes/{codeId}": {
      "schema": {
        "$ref": "#/backend/entities/GeneratedCode"
      },
      "description": "Stores publicly readable codes generated by an admin for a specific game."
    },
    "/participants/{participantId}/gameState/{gameStateId}": {
      "schema": {
        "$ref": "#/backend/entities/GameState"
      },
      "description": "Stores the game state for each participant. The participant ID is included in each gameState document, ensuring data access is restricted to the appropriate participant."
    },
    "/games/{gameId}/materials/{materialId}": {
      "schema": {
        "$ref": "#/backend/entities/Material"
      },
      "description": "Stores printable materials associated with a specific game. Admins can read and update these materials."
    },
    "/games/{gameId}/hints/{hintId}": {
      "schema": {
        "$ref": "#/backend/entities/Hint"
      },
      "description": "Stores all master hints for a game. Only admins can read or modify these."
    },
    "/games/{gameId}/teamHints/{teamHintId}": {
      "schema": {
        "$ref": "#/backend/entities/TeamHint"
      },
      "description": "Stores hints that have been revealed to specific teams by an admin. Players can only read hints intended for their team."
    }
  }
}

    